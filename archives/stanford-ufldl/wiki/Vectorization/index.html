
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Vectorization - Ufldl</title>
<link rel="stylesheet" href="/wayback-ufldl/stanford-ufldl/wiki/skins/common/shared.css" media="screen"/>
<link rel="stylesheet" href="/wayback-ufldl/stanford-ufldl/wiki/skins/monobook/main.css" media="screen"/>

</head>

<body class="mediawiki ltr ns-0 ns-subject page-Vectorization skin-monobook">
<div id="globalWrapper">
<div id="column-content"><div id="content">
	<a id="top"></a>
	
	<h1 id="firstHeading" class="firstHeading">Vectorization</h1>
	<div id="bodyContent">
		<h3 id="siteSub">From Ufldl</h3>
		<div id="contentSub"></div>
		<div id="jump-to-nav">Jump to: <a href="#column-one">navigation</a>, <a href="#searchInput">search</a></div>
<p>When working with learning algorithms, having a faster piece of code often 
means that you'll make progress faster on your project.  For example, if your
learning algorithm takes 20 minutes to run to completion, that means you can
"try" up to 3 new ideas per hour.  But if your code takes 20 hours to
run, that means you can "try" only one idea a day, since that's
how long you have to wait to get feedback from your program.  In this latter
case, if you can speed up your code so that it takes only 10 hours to run, 
that can literally double your personal productivity!  
</p><p><b>Vectorization</b> refers to a powerful way to speed up your algorithms. 
Numerical computing and parallel computing researchers have put decades of work
into making certain numerical operations (such as matrix-matrix multiplication,
matrix-matrix addition, matrix-vector multiplication) fast.  The idea of
vectorization is that we would like to express our learning algorithms
in terms of these highly optimized operations.  
</p><p>For example, if <img class="tex" alt="x \in \Re^{n+1}" src="/wayback-ufldl/stanford-ufldl/wiki/images/math/9/e/0/9e0394e64efaa9693a2099d90db59b26.png"/> and <img class="tex" alt="\textstyle \theta \in \Re^{n+1}" src="/wayback-ufldl/stanford-ufldl/wiki/images/math/8/c/d/8cd47b42536a589ad69927f408921808.png"/> are vectors 
and you need to compute <img class="tex" alt="\textstyle z = \theta^Tx" src="/wayback-ufldl/stanford-ufldl/wiki/images/math/b/6/3/b6353addb58dee1b547c654e31ad73d9.png"/>,
you can implement (in Matlab): 
</p>
<div dir="ltr" class="mw-geshi" style="text-align: left;"><div class="matlab source-matlab"><pre class="de1">z = <span class="nu0">0</span>;
<span class="kw1">for</span> <span class="kw2"><span class="re0">i</span></span>=<span class="nu0">1</span>:<span class="br0">&#40;</span>n+<span class="nu0">1</span><span class="br0">&#41;</span>,
  z = z + theta<span class="br0">&#40;</span><span class="kw2"><span class="re0">i</span></span><span class="br0">&#41;</span> * x<span class="br0">&#40;</span><span class="kw2"><span class="re0">i</span></span><span class="br0">&#41;</span>;
<span class="kw1">end</span>;</pre></div></div>
<p>or you can more simply implement
</p>
<div dir="ltr" class="mw-geshi" style="text-align: left;"><div class="matlab source-matlab"><pre class="de1">z = theta' * x;</pre></div></div>
<p>The second piece of code is not only simpler, but it will also run <i>much</i> faster. 
</p><p>More generally, a good rule-of-thumb for coding Matlab/Octave is:
</p>
<dl><dd><dl><dd><b>Whenever possible, avoid using explicit for-loops in your code.</b>
</dd></dl>
</dd></dl>
<p>In particular, the first code example used an explicit <tt>for</tt> loop.  By 
implementing the same functionality without the <tt>for</tt> loop, we sped
it up significantly.  A large part
of vectorizing our Matlab/Octave code will focus on getting rid of <tt>for</tt> loops,
since this lets Matlab/Octave extract more parallelism from your code, while
also incurring less computational overhead from the interpreter. 
</p><p>In terms of a strategy for writing your code, initially you may find that vectorized code is harder to write, read, and/or debug,
and that there may be a tradeoff in ease of programming/debugging vs. running
time.  Thus, for your first few programs, you might choose to first implement 
your algorithm without too many vectorization tricks, and verify that it is working correctly
(perhaps by running on a small problem).  Then only after it is working, you
can vectorize your code one piece at a time, pausing after each piece to verify
that your code is still computing the same result as before.  At the end, you'll
then hopefully have a correct, debugged, and vectorized/efficient piece of code.
</p><p>After you become familiar with the most common vectorization methods and tricks, 
you'll find that it usually isn't much effort to vectorize your code. Doing 
so will make your code run much faster and, in some cases, simplify it too.
</p><p><br/>
</p>
<div style="text-align: center;font-size:small;background-color: #eeeeee; border-style: solid; border-width: 1px; padding: 5px">
<p><strong class="selflink">Vectorization</strong> | <a href="/wayback-ufldl/stanford-ufldl/wiki/Logistic_Regression_Vectorization_Example" title="Logistic Regression Vectorization Example">Logistic Regression Vectorization Example</a> | <a href="/wayback-ufldl/stanford-ufldl/wiki/Neural_Network_Vectorization" title="Neural Network Vectorization">Neural Network Vectorization</a> | <a href="/wayback-ufldl/stanford-ufldl/wiki/Exercise_Vectorization" title="Exercise:Vectorization">Exercise:Vectorization</a>
</p>
</div>
<p><br/>
</p>
<div style="text-align: left;font-size:small;background-color: #eeeeee; border-style: solid; border-width: 1px; padding: 5px">
<p>Language&nbsp;: <a href="/wayback-ufldl/stanford-ufldl/wiki/%E7%9F%A2%E9%87%8F%E5%8C%96%E7%BC%96%E7%A8%8B" title="矢量化编程">中文</a>
</p>
</div>

<!-- 
NewPP limit report
Preprocessor node count: 26/1000000
Post-expand include size: 436/2097152 bytes
Template argument size: 21/2097152 bytes
Expensive parser function count: 0/100
-->

<div class="printfooter">
</div>		<div id="catlinks" class="catlinks catlinks-allhidden"></div>		<!-- end content -->
				<div class="visualClear"></div>
	</div>
</div></div>
<div id="column-one">
	<div id="p-cactions" class="portlet">
		<h5>Views</h5>
		<div class="pBody">
			<ul>
				 <li id="ca-nstab-main" class="selected"><a href="/wayback-ufldl/stanford-ufldl/wiki/Vectorization" title="View the content page [c]" accesskey="c">Page</a></li>
				 <li id="ca-talk"><a href="" title="Discussion about the content page [t]" accesskey="t">Discussion</a></li>
				 <li id="ca-viewsource"><a href="" title="This page is protected.
You can view its source [e]" accesskey="e">View source</a></li>
				 <li id="ca-history"><a href="" title="Past revisions of this page [h]" accesskey="h">History</a></li>
			</ul>
		</div>
	</div>
	<div class="portlet" id="p-personal">
		<h5>Personal tools</h5>
		<div class="pBody">
			<ul>
			</ul>
		</div>
	</div>
	<div class="portlet" id="p-logo">
		<a style="background-image: url(/wayback-ufldl/stanford-ufldl/wiki/skins/common/images/dolphin-openclipart.png);" href="/wayback-ufldl/stanford-ufldl/wiki/Main_Page" title="Visit the main page"></a>
	</div>
	<script type="text/javascript"> if (window.isMSIE55) fixalpha(); </script>
	<div class="generated-sidebar portlet" id="p-ufldl_resources">
		<h5>ufldl resources</h5>
		<div class="pBody">
			<ul>
				<li id="n-UFLDL-Tutorial"><a href="/wayback-ufldl/stanford-ufldl/wiki/UFLDL_Tutorial">UFLDL Tutorial</a></li>
				<li id="n-Recommended-Readings"><a href="/wayback-ufldl/stanford-ufldl/wiki/UFLDL_Recommended_Readings">Recommended Readings</a></li>
			</ul>
		</div>
	</div>
	<div class="generated-sidebar portlet" id="p-wiki">
		<h5>wiki</h5>
		<div class="pBody">
			<ul>
				<li id="n-mainpage-description"><a href="/wayback-ufldl/stanford-ufldl/wiki/Main_Page" title="Visit the main page [z]" accesskey="z">Main page</a></li>
				<li id="n-recentchanges"><a href="" title="The list of recent changes in the wiki [r]" accesskey="r">Recent changes</a></li>
				<li id="n-randompage"><a href="" title="Load a random page [x]" accesskey="x">Random page</a></li>
				<li id="n-help"><a href="" title="The place to find out">Help</a></li>
			</ul>
		</div>
	</div>
	<div id="p-search" class="portlet">
		<h5><label for="searchInput">Search</label></h5>
		<div id="searchBody" class="pBody">
			<form action="" id="searchform">
				<input type="hidden" name="title" value="Special:Search" disabled/>
				<input id="searchInput" title="Search Ufldl" accesskey="f" type="search" name="search" disabled/>
				<input type="submit" name="go" class="searchButton" id="searchGoButton" value="Go" title="Go to a page with this exact name if exists" disabled/>&nbsp;
				<input type="submit" name="fulltext" class="searchButton" id="mw-searchButton" value="Search" title="Search the pages for this text" disabled/>
			</form>
		</div>
	</div>
	<div class="portlet" id="p-tb">
		<h5>Toolbox</h5>
		<div class="pBody">
			<ul>
				<li id="t-whatlinkshere"><a href="" title="List of all wiki pages that link here [j]" accesskey="j">What links here</a></li>
				<li id="t-recentchangeslinked"><a href="" title="Recent changes in pages linked from this page [k]" accesskey="k">Related changes</a></li>
<li id="t-specialpages"><a href="" title="List of all special pages [q]" accesskey="q">Special pages</a></li>
				<li id="t-print"><a href="" rel="alternate" title="Printable version of this page [p]" accesskey="p">Printable version</a></li>				<li id="t-permalink"><a href="" title="Permanent link to this revision of the page">Permanent link</a></li>			</ul>
		</div>
	</div>
</div><!-- end of the left (by default at least) column -->
<div class="visualClear"></div>
<div id="footer">
	<ul id="f-list">
		<li id="lastmod"> This page was last modified on 7 April 2013, at 13:07.</li>
		<li id="privacy"><a href="/wayback-ufldl/stanford-ufldl/wiki/Ufldl_Privacy_policy" title="Ufldl:Privacy policy">Privacy policy</a></li>
		<li id="about"><a href="/wayback-ufldl/stanford-ufldl/wiki/Ufldl_About" title="Ufldl:About">About Ufldl</a></li>
		<li id="disclaimer"><a href="/wayback-ufldl/stanford-ufldl/wiki/Ufldl_General_disclaimer" title="Ufldl:General disclaimer">Disclaimers</a></li>
	</ul>
</div>
</div>

<!-- Served in 0.114 secs. -->
</body>
</html>
